<html>
<head>
    <!-- Include stylesheet -->
    <link href="/styleControl.css" type ="text/css" rel="stylesheet">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="/socket.io/socket.io.js"></script>
    <!-- Include the Quill library -->
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="//cdn.quilljs.com/1.3.6/quill.min.js"></script>
    
</head>

<!-- Initialize Quill editor -->
<script>var socket = io();</script>
    <body>
        <div id="text_zone" >
            <div id="editor">
            </div>
        </div>
        <script>
            var toolbarOptions = [
            ['bold', 'italic', 'underline'],        // toggled buttons
            [{ 'direction': 'rtl' }],                         // text direction

            [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme
            [{ 'font': [] }],
            ['image'],
            ['clean']                                         // remove formatting button
            ];
            var quill = new Quill('#editor',{
            modules: {
                toolbar: toolbarOptions
            }, 
                theme: 'snow'
            });
            var socket = io.connect('http://localhost:3000');
            function postMyMessage() {
                var validation = window.confirm("Post this message ?")
                if (validation) {
                    socket.emit('message',quill.getText());
                }
            }
            </script>
        <button onclick="postMyMessage()">Post</button>

        <form name="messageForm" onsubmit="return run_this_function()">
  
                Message:<br>
                <input type="text" name="message" id="message"><br/>
                Color or html color code:<br>
                <input type="text" name="color" id="color"><br/>
                Image:<br>
                <input type="file"
                id="image" name="image"
                accept="image/png, image/jpeg"><br/><br/>
                <input type="submit" value="Submit">
                
        </form>
        <script>
              function run_this_function(){
                var validation = window.confirm("Post this message ?")
                if (validation) {
                    var message = document.getElementById("message").value;
                    var color = document.getElementById("color").value;
                    var path = document.getElementById("image").value;
                    var img = document.createElement("IMG");
                    img.setAttribute("src", path);
                    img = img.toString('base64');
                    socket.emit('message',{ message, color, img});
                }
            }
        </script>
    </body>
</html>